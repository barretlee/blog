<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><title>HTTPS证书生成原理和部署细节 | 小胡子哥的个人网站</title><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,user-scalable=0"><meta name="author" content="https://plus.google.com/112634278852964994392?hl=zh-cn"><meta name="email" content="barret.china@gmail.com"><meta name="description" content="今天摸索了下 HTTPS 的证书生成，以及他在 Nginx 上的部署。由于博客托管在 github 上，没办法部署证书，先记录下，后续有需要方便快捷操作。"><meta property="og:type" content="article"><meta property="og:title" content="HTTPS证书生成原理和部署细节 | 小胡子哥的个人网站"><meta property="og:url" content="https://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/"><meta property="og:site_name" content="HTTPS证书生成原理和部署细节"><meta property="og:description" content="今天摸索了下 HTTPS 的证书生成，以及他在 Nginx 上的部署。由于博客托管在 github 上，没办法部署证书，先记录下，后续有需要方便快捷操作。"><meta name="generator" content="https://hexo.io"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link href="https://img.alicdn.com/imgextra/i4/O1CN01LKRotr20M1ZGJkT3v_!!6000000006834-2-tps-1200-1200.png" rel="apple-touch-icon-precomposed"><link rel="shoticon" href="https://img.alicdn.com/imgextra/i3/O1CN01EVx62B1eyZLyJsJnY_!!6000000003940-2-tps-100-100.png" type="image/x-icon"><link rel="alternate" type="application/rss+xml" href="https://www.barretlee.com/rss2.xml" title="小胡子哥的个人网站"><link rel="prev" href="https://www.barretlee.com/blog/2015/10/07/debug-nodejs-in-command-line/" title="NodeJS的代码调试和性能调优"><link rel="next" href="https://www.barretlee.com/blog/2015/09/30/confusion-about-for-loop-var/" title="JavaScript 关于 for 循环中的疑问"><link rel="start" href="https://www.barretlee.com/entry/" title="Blog Entry"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/barretlee/blog@gh-pages/public/css/style-20230627-2.css"></head><body><div class="rainbow"></div><div class="container"><span class="local-search local-search-google local-search-plugin" style="display:none"><input type="search" placeholder="站内搜索" id="local-search-input" class="local-search-input-cls"> <i class="icon" aria-hidden="true" title="点击进入 Google 搜索">&#x2708;</i><div id="local-search-result" class="local-search-result-cls"></div></span><div class="article" itemscope itemtype="http://schema.org/Article"><div class="post"><div class="bread"><a href="/">小胡子哥的个人网站</a> » <a href="/entry/">博客</a> » <a class="category-link" href="/blog/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></div><div class="post-title-wrapper"><h1 class="post-title" itemprop="name">HTTPS证书生成原理和部署细节</h1><a href="/about/"><img style="max-width:120px" src="https://img.alicdn.com/imgextra/i1/O1CN01zmj6R326ehPa0NZO2_!!6000000007687-2-tps-1200-1200.png" alt="Barret李靖"></a></div><div class="post-info"><span>作者: <a href="/about/">Barret李靖</a></span> <span><time itemprop="timeCreated" aria-hidden="true">2015-10-05 15:29:39</time> <span class="aria-readonly">本文发布时间为2015年10月05日15时29分39秒</span> </span><span>分类: <a class="category-link" href="/blog/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a> </span><span tabindex="0" aria-hidden="true">标签: <a class="article-tag-none-link" href="/blog/tags/HTTPS/" rel="tag">HTTPS</a> </span><span class="aria-readonly">下面是正文内容</span> <span tabindex="0" aria-hidden="true">评论数: <a href="#comments" class="ds-thread-count hash-to-comments disqus-comment-count" data-thread-key="how-to-build-a-https-server" data-disqus-identifier="how-to-build-a-https-server"></a></span></div><div class="post-content" itemprop="articleBody"><p>今天摸索了下 HTTPS 的证书生成，以及它在 Nginx 上的部署。由于博客托管在 github 上，没办法部署证书，先记录下，后续有需要方便快捷操作。本文的阐述不一定完善，但是可以让一个初学者了解大致的原理，同时跟着操作可以为自己的博客&#x2F;网站部署一个 HTTPS 证书。</p><p><a href="//www.hallaminternet.com/assets/https.jpg"><img src="https://raw.githubusercontent.com/barretlee/blog/gh-pages/blogimgs/2015/10/05/20151001_65a3140b.jpg" alt="https"></a></p><span id="more"></span><h3 id="网站部署-HTTPS-的重要性"><a href="#网站部署-HTTPS-的重要性" class="headerlink" title="网站部署 HTTPS 的重要性"></a>网站部署 HTTPS 的重要性</h3><p>看看下面，部分电信用户访问京东首页的时候，会看到右下角有一个浮动广告：</p><p><img src="https://raw.githubusercontent.com/barretlee/blog/gh-pages/blogimgs/2015/10/05/20151001_b342b301.jpg" alt="京东首页被电信DNS注入"></p><p>小白用户以为是京东有意放置的，细心的用户会发现，这个 iframe 一层嵌一层的恶心广告很明显是电信&#x2F;中间人通过 DNS 劫持注入进去的，十分恶心，没有关闭按钮。</p><p>随着互联网的快速发展，我们几乎离不开网络了，聊天、预订酒店、购物等等，我们的隐私无时无刻不暴露在这庞大的网络之中，HTTPS 能够让信息在网络中的传递更加安全，增加了 haker 的攻击成本。</p><p>HTTPS 区别于 HTTP，它多了加密(encryption)，认证(verification)，鉴定(identification)。它的安全源自非对称加密以及第三方的 CA 认证。</p><h3 id="简述-HTTPS-的运作"><a href="#简述-HTTPS-的运作" class="headerlink" title="简述 HTTPS 的运作"></a>简述 HTTPS 的运作</h3><p><a  target="_blank" href="http://image.beekka.com/blog/2014/bg2014092003.png"><img src="https://raw.githubusercontent.com/barretlee/blog/gh-pages/blogimgs/2015/10/05/20151001_b347f684.jpg" alt="HTTPS交互"></a></p><p>如上图所示，简述如下：</p><ul><li>客户端生成一个随机数 <code>random-client</code>，传到服务器端（Say Hello)</li><li>服务器端生成一个随机数 <code>random-server</code>，和着公钥，一起回馈给客户端（I got it)</li><li>客户端收到的东西原封不动，加上 <code>premaster secret</code>（通过 <code>random-client</code>、<code>random-server</code> 经过一定算法生成的东西），再一次送给服务器端，这次传过去的东西会使用公钥加密</li><li>服务器端先使用私钥解密，拿到 <code>premaster secret</code>，此时客户端和服务器端都拥有了三个要素：<code>random-client</code>、<code>random-server</code> 和 <code>premaster secret</code></li><li>此时安全通道已经建立，以后的交流都会校检上面的三个要素通过算法算出的 <code>session key</code></li></ul><h3 id="CA-数字证书认证中心"><a href="#CA-数字证书认证中心" class="headerlink" title="CA 数字证书认证中心"></a>CA 数字证书认证中心</h3><p>如果网站只靠上图运作，可能会被中间人攻击，试想一下，在客户端和服务端中间有一个中间人，两者之间的传输对中间人来说是透明的，那么中间人完全可以获取两端之间的任何数据，然后将数据原封不动的转发给两端，由于中间人也拿到了三要素和公钥，它照样可以解密传输内容，并且还可以篡改内容。</p><p>为了确保我们的数据安全，我们还需要一个 CA 数字证书。HTTPS的传输采用的是非对称加密，一组非对称加密密钥包含公钥和私钥，通过公钥加密的内容只有私钥能够解密。上面我们看到，整个传输过程，服务器端是没有透露私钥的。而 CA 数字认证涉及到私钥，整个过程比较复杂，我也没有很深入的了解，后续有详细了解之后再补充下。</p><p>CA 认证分为三类：DV ( domain validation)，OV ( organization validation)，EV ( extended validation)，证书申请难度从前往后递增，貌似 EV 这种不仅仅是有钱就可以申请的。</p><p>对于一般的小型网站尤其是博客，可以使用自签名证书来构建安全网络，所谓自签名证书，就是自己扮演 CA 机构，自己给自己的服务器颁发证书。</p><h3 id="生成密钥、证书"><a href="#生成密钥、证书" class="headerlink" title="生成密钥、证书"></a>生成密钥、证书</h3><p>第一步，为服务器端和客户端准备公钥、私钥</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 生成服务器端私钥</span></span><br><span class="line">openssl genrsa -out server.key 1024</span><br><span class="line"><span class="comment"># 生成服务器端公钥</span></span><br><span class="line">openssl rsa -<span class="keyword">in</span> server.key -pubout -out server.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成客户端私钥</span></span><br><span class="line">openssl genrsa -out client.key 1024</span><br><span class="line"><span class="comment"># 生成客户端公钥</span></span><br><span class="line">openssl rsa -<span class="keyword">in</span> client.key -pubout -out client.pem</span><br></pre></td></tr></table></figure><p>第二步，生成 CA 证书</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 生成 CA 私钥</span></span><br><span class="line">openssl genrsa -out ca.key 1024</span><br><span class="line"><span class="comment"># X.509 Certificate Signing Request (CSR) Management.</span></span><br><span class="line">openssl req -new -key ca.key -out ca.csr</span><br><span class="line"><span class="comment"># X.509 Certificate Data Management.</span></span><br><span class="line">openssl x509 -req -<span class="keyword">in</span> ca.csr -signkey ca.key -out ca.crt</span><br></pre></td></tr></table></figure><p>在执行第二步时会出现：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜  keys  openssl req -new -key ca.key -out ca.csr</span><br><span class="line">You are about to be asked to enter information that will be incorporated</span><br><span class="line">into your certificate request.</span><br><span class="line">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class="line">There are quite a few fields but you can leave some blank</span><br><span class="line">For some fields there will be a default value,</span><br><span class="line">If you enter <span class="string">&#x27;.&#x27;</span>, the field will be left blank.</span><br><span class="line">-----</span><br><span class="line">Country Name (2 letter code) [AU]:CN</span><br><span class="line">State or Province Name (full name) [Some-State]:Zhejiang</span><br><span class="line">Locality Name (eg, city) []:Hangzhou</span><br><span class="line">Organization Name (eg, company) [Internet Widgits Pty Ltd]:My CA</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br><span class="line">Common Name (e.g. server FQDN or YOUR name) []:localhost</span><br><span class="line">Email Address []:</span><br></pre></td></tr></table></figure><p>注意，这里的 <code>Organization Name (eg, company) [Internet Widgits Pty Ltd]:</code> 后面生成客户端和服务器端证书的时候也需要填写，不要写成一样的！！！可以随意写如：My CA, My Server, My Client。</p><p>然后 <code>Common Name (e.g. server FQDN or YOUR name) []:</code> 这一项，是最后可以访问的域名，我这里为了方便测试，写成 <code>localhost</code>，如果是为了给我的网站生成证书，需要写成 <code>barretlee.com</code>。</p><p>第三步，生成服务器端证书和客户端证书</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 服务器端需要向 CA 机构申请签名证书，在申请签名证书之前依然是创建自己的 CSR 文件</span></span><br><span class="line">openssl req -new -key server.key -out server.csr</span><br><span class="line"><span class="comment"># 向自己的 CA 机构申请证书，签名过程需要 CA 的证书和私钥参与，最终颁发一个带有 CA 签名的证书</span></span><br><span class="line">openssl x509 -req -CA ca.crt -CAkey ca.key -CAcreateserial -<span class="keyword">in</span> server.csr -out server.crt</span><br><span class="line"></span><br><span class="line"><span class="comment"># client 端</span></span><br><span class="line">openssl req -new -key client.key -out client.csr</span><br><span class="line"><span class="comment"># client 端到 CA 签名</span></span><br><span class="line">openssl x509 -req -CA ca.crt -CAkey ca.key -CAcreateserial -<span class="keyword">in</span> client.csr -out client.crt</span><br></pre></td></tr></table></figure><p>此时，我们的 keys 文件夹下已经有如下内容了：</p><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── https-client<span class="selector-class">.js</span></span><br><span class="line">├── https-server<span class="selector-class">.js</span></span><br><span class="line">└── keys</span><br><span class="line">    ├── ca<span class="selector-class">.crt</span></span><br><span class="line">    ├── ca<span class="selector-class">.csr</span></span><br><span class="line">    ├── ca<span class="selector-class">.key</span></span><br><span class="line">    ├── ca<span class="selector-class">.pem</span></span><br><span class="line">    ├── ca<span class="selector-class">.srl</span></span><br><span class="line">    ├── client<span class="selector-class">.crt</span></span><br><span class="line">    ├── client<span class="selector-class">.csr</span></span><br><span class="line">    ├── client<span class="selector-class">.key</span></span><br><span class="line">    ├── client<span class="selector-class">.pem</span></span><br><span class="line">    ├── server<span class="selector-class">.crt</span></span><br><span class="line">    ├── server<span class="selector-class">.csr</span></span><br><span class="line">    ├── server<span class="selector-class">.key</span></span><br><span class="line">    └── server.pem</span><br></pre></td></tr></table></figure><p>看到上面两个 js 文件了么，我们来跑几个demo。</p><h3 id="HTTPS本地测试"><a href="#HTTPS本地测试" class="headerlink" title="HTTPS本地测试"></a>HTTPS本地测试</h3><p>服务器代码：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// file http-server.js</span></span><br><span class="line"><span class="keyword">var</span> https = <span class="built_in">require</span>(<span class="string">&#x27;https&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">  <span class="attr">key</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./keys/server.key&#x27;</span>),</span><br><span class="line">  <span class="attr">cert</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./keys/server.crt&#x27;</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">https.<span class="title function_">createServer</span>(options, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">200</span>);</span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">8000</span>);</span><br></pre></td></tr></table></figure><p>短短几行代码就构建了一个简单的 https 服务器，options 将私钥和证书带上。然后利用 curl 测试：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜  https  curl //localhost:8000</span><br><span class="line">curl: (60) SSL certificate problem: Invalid certificate chain</span><br><span class="line">More details here: http://curl.haxx.se/docs/sslcerts.html</span><br><span class="line"></span><br><span class="line">curl performs SSL certificate verification by default, using a <span class="string">&quot;bundle&quot;</span></span><br><span class="line"> of Certificate Authority (CA) public keys (CA certs). If the default</span><br><span class="line"> bundle file isn<span class="string">&#x27;t adequate, you can specify an alternate file</span></span><br><span class="line"><span class="string"> using the --cacert option.</span></span><br><span class="line"><span class="string">If this HTTPS server uses a certificate signed by a CA represented in</span></span><br><span class="line"><span class="string"> the bundle, the certificate verification probably failed due to a</span></span><br><span class="line"><span class="string"> problem with the certificate (it might be expired, or the name might</span></span><br><span class="line"><span class="string"> not match the domain name in the URL).</span></span><br><span class="line"><span class="string">If you&#x27;</span>d like to turn off curl<span class="string">&#x27;s verification of the certificate, use</span></span><br><span class="line"><span class="string"> the -k (or --insecure) option.</span></span><br></pre></td></tr></table></figure><p>当我们直接访问时，<code>curl //localhost:8000</code> 一堆提示，原因是没有经过 CA 认证，添加 <code>-k</code> 参数能够解决这个问题：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜  https  curl -k //localhost:8000</span><br><span class="line">hello world%</span><br></pre></td></tr></table></figure><p>这样的方式是不安全的，存在我们上面提到的中间人攻击问题。可以搞一个客户端带上 CA 证书试试：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// file http-client.js</span></span><br><span class="line"><span class="keyword">var</span> https = <span class="built_in">require</span>(<span class="string">&#x27;https&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">  <span class="attr">hostname</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">  <span class="attr">port</span>: <span class="number">8000</span>,</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">  <span class="attr">methed</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">  <span class="attr">key</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./keys/client.key&#x27;</span>),</span><br><span class="line">  <span class="attr">cert</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./keys/client.crt&#x27;</span>),</span><br><span class="line">  <span class="attr">ca</span>: [fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./keys/ca.crt&#x27;</span>)]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">options.<span class="property">agent</span> = <span class="keyword">new</span> https.<span class="title class_">Agent</span>(options);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> req = https.<span class="title function_">request</span>(options, <span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">setEncoding</span>(<span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(d);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">req.<span class="title function_">end</span>();</span><br><span class="line"></span><br><span class="line">req.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>先打开服务器 <code>node http-server.js</code>，然后执行</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">➜  https  node https-client.<span class="property">js</span></span><br><span class="line">hello world</span><br></pre></td></tr></table></figure><p>如果你的代码没有输出 <code>hello world</code>，说明证书生成的时候存在问题。也可以通过浏览器访问：</p><p><img src="https://raw.githubusercontent.com/barretlee/blog/gh-pages/blogimgs/2015/10/05/20151001_9bf819eb.jpg" alt="https证书问题"></p><p>提示错误：</p><blockquote><p>此服务器无法证明它是localhost；您计算机的操作系统不信任其安全证书。出现此问题的原因可能是配置有误或您的连接被拦截了。</p></blockquote><p>原因是浏览器没有 CA 证书，只有 CA 证书，服务器才能够确定，这个用户就是真实的来自 localhost 的访问请求（比如不是代理过来的）。</p><p>你可以点击 <code>继续前往localhost（不安全）</code> 这个链接，相当于执行 <code>curl -k //localhost:8000</code>。如果我们的证书不是自己颁发，而是去靠谱的机构去申请的，那就不会出现这样的问题，因为靠谱机构的证书会放到浏览器中，浏览器会帮我们做很多事情。初次尝试的同学可以去 <a href="//startssl.com">startssl.com</a> 申请一个免费的证书。</p><h3 id="Nginx-部署"><a href="#Nginx-部署" class="headerlink" title="Nginx 部署"></a>Nginx 部署</h3><p>ssh 到你的服务器，对 Nginx 做如下配置：</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">server_names</span> barretlee.com <span class="regexp">*.barretlee.com</span></span><br><span class="line">ssl <span class="literal">on</span>;</span><br><span class="line"><span class="attribute">ssl_certificate</span> /etc/nginx/ssl/barretlee.com.crt;</span><br><span class="line"><span class="attribute">ssl_certificate_key</span> /etc/nginx/ssl/barretlee.com.key;</span><br><span class="line"><span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line"><span class="attribute">ssl_ciphers</span> <span class="string">&quot;EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4EECDH EDH+aRSA RC4 !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !MEDIUM&quot;</span>;</span><br><span class="line"><span class="comment"># Add perfect forward secrecy</span></span><br><span class="line"><span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line"><span class="attribute">add_header</span> Strict-Transport-Security <span class="string">&quot;max-age=31536000; includeSubdomains&quot;</span>;</span><br></pre></td></tr></table></figure><p>会发现，网页 URL 地址框左边已经多出了一个小绿锁。当然，部署好了之后可以去<a href="//www.ssllabs.com/ssltest/analyze.html">这个网站</a>看看测评分数，如果分数是 A+，说明你的 HTTPS 的各项配置都还不错，速度也很快。</p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>好吧，我也是初次尝试，本地测试是 ok 的，由于买的阿里云服务器到期了也没续费，就没远程折腾，其实本地 Nginx + Nodejs，然后 Hosts 配置域名也是可以较好模拟的。文中很多地方描述的可能不是十分准确，提到的点也不够全面，如果有错误，还请斧正！</p></div></div><div class="old-article-warning">本文在 <b>3575</b> 天之前发表，技术更替飞快，文中部分内容可能已经过时，如有疑问，请联系作者 <a href="/about">Barret李靖</a>。</div><div class="copyright" itemscope itemtype="http://schema.org/ProfilePage" tabindex="0" aria-hidden="true"><ul><li>作者: <a href="/about/" itemprop="name">Barret李靖</a></li><li>文章分类: <a class="category-link" href="/blog/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></li><li>文章标签: <a class="article-tag-none-link" href="/blog/tags/HTTPS/" rel="tag">HTTPS</a></li><li>发表日期: 2015-10-05 15:29:39</li><li>最后编辑时间: 2025-07-19 11:01:03</li><li>本文 Markdown 地址: <a target="_
			" href="https://github.com/barretlee/blog/tree/master/blog/src/_posts/2015-10-05-how-to-build-a-https-server.md">HTTPS证书生成原理和部署细节</a></li><li>版权声明：<a  target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">CC BY-NC-ND 3.0</a></li><li>Feed 订阅: <a href="/rss2.xml"><i class="icon">&#x25c8;</i></a><div style="opacity:.3;text-align:right;margin:5px -5px -10px 0;float:right;font-size:12px">编辑本文：<a  target="_blank" href="https://github.com/barretlee/blog/edit/master/blog/src/_posts/2015-10-05-how-to-build-a-https-server.md" target="_blank" aria-hidden="true"><i class="icon">&#xe622;</i></a>； 新建文章：<a  target="_blank" href="https://github.com/barretlee/blog/new/master/blog/src/_posts" target="_blank" aria-hidden="true"><i class="icon">&#xe616;</i></a></div></li></ul><a href="/about/"><img style="max-width:120px" src="https://img.alicdn.com/imgextra/i3/O1CN01tDYnfz23AWT1ag79p_!!6000000007215-2-tps-1200-1200.png"></a></div><em class="arrow-expend" tabindex="0" aria-hidden="0" aria-label="点击展开网页导航" aria-selected="true" aria-lable="网页导航" aria-expanded="false" id="i1">▾<ul role="group" aria-labelledby="i1" aria-expanded="false"><li><a href="/entry/">博客</a></li><li><a href="/message/">留言</a></li><li><a href="/demo/">实验室</a></li><li><a href="/friends/">友情链接</a></li></ul></em></div><div class="post-relative"><div class="page-relative"><a href="/blog/2015/10/07/debug-nodejs-in-command-line/" class="post-prev"><i class="icon" tabindex="0" aria-hidden="true">&#x261c;</i> <span class="aria-readonly">上一篇文章</span> <b>NodeJS的代码调试和性能调优</b> </a><a href="/blog/2015/09/30/confusion-about-for-loop-var/" class="post-next"><span class="aria-readonly">下一篇文章</span> <b>JavaScript 关于 for 循环中的疑问</b> <i class="icon" tabindex="0" aria-hidden="true">&#xe602;</i></a></div><div class="page-relative-fixed" tabindex="0" aria-hidden="true"><a href="/blog/2015/10/07/debug-nodejs-in-command-line/" class="prev" title="NodeJS的代码调试和性能调优"><i class="icon">&#xe600;</i> <b>NodeJS的代码调试和性能调优</b> </a><a href="/blog/2015/09/30/confusion-about-for-loop-var/" class="next" title="JavaScript 关于 for 循环中的疑问"><i class="icon">&#x261e;</i> <b>JavaScript 关于 for 循环中的疑问</b></a></div></div></div><div class="sidebar" tabindex="0" aria-hidden="true"><div class="func-btns func-btns-up"><span class="func-item"><i class="func-nav icon">&#xe618;<span>目录</span></i><div><i class="left-arrow"></i><i class="left-arrow-clone"></i> <a href="javascript:void(0);" onclick="return!1">显示目录</a></div></span><span class="func-item"><i class="func-font icon">&#xe604;<span>夜间</span></i><div class="font-choose-box"><i class="left-arrow"></i><i class="left-arrow-clone"></i><div class="font-choose bg-choose"><a href="javascript:void(0)" onclick="return!1" class="bg-type bg-type-sun font-type-song"><i class="icon">&#xe61a;</i></a> <a href="javascript:void(0)" onclick="return!1" class="bg-type bg-type-moon font-type-hei"><i class="icon">&#xe619;</i></a></div></div></span><span class="func-item"><i class="func-about icon">&#x263b;<span>关于</span></i><div><i class="left-arrow"></i><i class="left-arrow-clone"></i><p><a href="/about/" class="func-about-link" target="_blank">关于作者</a></p><div id="followMeOnWeibo"></div></div></span></div><div class="func-btns"><span class="func-item"><a href="/friends/" target="_blank"><i class="func-rss icon">&#xe601;<span>链接</span></i></a><div><i class="left-arrow"></i><i class="left-arrow-clone"></i> <a href="/friends/" target="_blank">友情链接</a></div></span><span class="func-item"><a href="/rss2.xml" target="_blank"><i class="func-rss icon">&#x25c8;<span>订阅</span></i></a><div><i class="left-arrow"></i><i class="left-arrow-clone"></i><a href="/rss2.xml" target="_blank">订阅我吧！</a></div></span></div></div><div class="single-page-footer"><div class="footer"><div class="footer-wraper"><div class="footer-content"><div class="footer-nav"><a href="javascript: void(0);" class="ds-thread-count disqus-comment-count" data-thread-key="how-to-build-a-https-server" data-disqus-identifier="how-to-build-a-https-server" tabindex="0" aria-hidden="true">评论内容</a> <a href="javascript: void(0);" id="comments">相关文章</a> <a href="/friends/" tabindex="0" aria-hidden="true" style="display:none">友情链接</a></div><div class="nav-detail"><div tabindex="0"><div id="gitalk" sid="how-to-build-a-https-server"></div><script charset="utf-8" type="text/javascript" src="https://fastly.jsdelivr.net/gh/barretlee/blog@gh-pages/public/js/gitalk.js"></script><script type="text/javascript">var postContent=document.querySelectorAll(".post-content>p");postContent&&postContent.length&&(postContent=(postContent=postContent.item(0).textContent+(postContent.item(1)&&postContent.item(1).textContent||"")).length>140?postContent.slice(0,140)+"...":postContent);var gitalk=new Gitalk({clientID:"50a1b3aa7854b01a1c85",clientSecret:"226ac154f80a6aea0985da874126b35795f22eed",language:"zh-CN",perPage:100,createIssueManually:!1,repo:"blog",owner:"barretlee",admin:["barretlee"],id:"how-to-build-a-https-server",body:"原文地址："+location.href+"\n\n文摘："+postContent,distractionFreeMode:!1});window.addEventListener("load",(function(){gitalk.render("gitalk")}));var commentTimer=setInterval(()=>{var t=document.querySelector(".gt-link-counts"),e=document.querySelector(".hash-to-comments");t&&e&&(e.textContent=t.textContent,clearInterval(commentTimer))},500);setTimeout(()=>{clearInterval(commentTimer)},6e4)</script></div><div style="display:block"><div class="relative-wrapper"><div class="relative-article"><ul><li><span><font aria-hidden="true">2016-08-25 »</font> </span><a href="/blog/2016/08/25/pac-file/">详解代理自动配置 PAC</a> <span class="aria-readonly">发表时间为2016年08月25日</span><div class="relative-box"><a href="/blog/2016/08/25/pac-file/" class="relative-img-wrapper"><img src="https://raw.githubusercontent.com/barretlee/blog/gh-pages/blogimgs/2016/08/25/6c0378f8gw1f75co9fseuj20p00dwwhk.jpg" style="width:100%" loading="lazy" data-original="/../blogimgs/2016/08/25/6c0378f8gw1f75co9fseuj20p00dwwhk.jpg"></a><span class="aria-readonly">文章概要 </span>最近一直在做跨域中华局域网的工作，了解了很多代理知识和基础概念，很零散，也很细碎。希望通过一段时间的学习，能够自由地穿梭在国际互联网和中华局域网之间。后续会写一系列文章记录我了解到的知识点，本文要说的是我们平时接触比较多的 PAC，全名为 proxy auto-config。--></div></li><li><span><font aria-hidden="true">2016-04-24 »</font> </span><a href="/blog/2016/04/24/detail-about-ca-and-certs/">细说 CA 和证书</a> <span class="aria-readonly">发表时间为2016年04月24日</span><div class="relative-box"><a href="/blog/2016/04/24/detail-about-ca-and-certs/" class="relative-img-wrapper"><img src="https://raw.githubusercontent.com/barretlee/blog/gh-pages/blogimgs/2016/04/24/6c0378f8gw1f36o0231kaj20fh0dd0ti.jpg" style="width:100%" loading="lazy" data-original="/../blogimgs/2016/04/24/6c0378f8gw1f36o0231kaj20fh0dd0ti.jpg"></a><span class="aria-readonly">文章概要 </span>CA，Catificate Authority，它的作用就是提供证书（即服务器证书，由域名、公司信息、序列号和签名信息组成）加强服务端和客户端之间信息交互的安全性，以及证书运维相关服务。任何个体&#x2F;组织都可以扮演 CA 的角色，只不过难以得到客户端的信任，能够受浏览器默认信任的 CA 大厂商有很多，其中 TOP5 是 Symantec、Comodo、Godaddy、GolbalSign 和 Digicert。</div></li><li><span><font aria-hidden="true">2016-04-06 »</font> </span><a href="/blog/2016/04/06/operation-not-permitted-problem-in-linux-or-unix-system/">Unix/Linux 系统中的 Operation Not Permitted 问题</a> <span class="aria-readonly">发表时间为2016年04月06日</span><div class="relative-box"><span class="aria-readonly">文章概要 </span>多次在 Mac 使用过程中遇到 Operation Not Permitted 问题，之前都是略过，今天好好摸索了一把，搞明白了道理，记录下来。</div></li><li><span><font aria-hidden="true">2016-02-23 »</font> </span><a href="/blog/2016/02/23/wifi-key/">WiFi 万能钥匙原理和危害探究</a> <span class="aria-readonly">发表时间为2016年02月23日</span><div class="relative-box"><span class="aria-readonly">文章概要 </span>本文不会从代码角度分析 WiFi 万能钥匙这个软件是如何「破解」密码的，主要从使用这个软件后的感受出发，分析它可能会用到的手段以及可能存在的风险。</div></li></ul></div></div><div class="relative-to-comment" tabindex="0" aria-hidden="true"><span>留下评论</span></div></div><div class="friends-box"><ul><li><a  target="_blank" href="http://hustskyking.cnblogs.com" target="_blank">旧博客</a> <font aria-hidden="true">»</font> <span>我的旧博客（博客园荣誉博客）</span></li><li><a  target="_blank" href="http://www.zhangmengxue.com" target="_blank">大额</a> <font aria-hidden="true">»</font> <span>大额大额哼歌等日落</span></li><li><a  target="_blank" href="http://www.zhangxinxu.com" target="_blank">张鑫旭</a> <font aria-hidden="true">»</font> <span>原来大学我俩一个团队的~</span></li><li><a  target="_blank" href="http://web-tinker.com" target="_blank">次碳酸钴</a> <font aria-hidden="true">»</font> <span>深度交流的一个好朋友</span></li><li><a  target="_blank" href="http://imququ.com" target="_blank">屈屈</a> <font aria-hidden="true">»</font> <span>蛐蛐同学</span></li><li><a  target="_blank" href="http://www.ruanyifeng.com" target="_blank">阮一峰</a> <font aria-hidden="true">»</font> <span>阮老师</span></li><li><a href="/friends/">更多列表 <font aria-hidden="true">»</font></a></li></ul></div></div><div class="website-info" aria-hidden="true"><a class="page_editor" href="/admin/#/posts/cmd9nvpe300kvqk9b1ni1fb61" target="_blank">🙈</a> <span>&copy;2013-2025 <small><a  target="_blank" href="https://www.miit.gov.cn/" about="_blank">湘ICP备14007107号-1</a></small></span> 本站由 <a href="/">Barret李靖</a> 纯手工打造 | <a href="/about#contact">联系方式</a> <a  target="_blank" href="https://union.zhaodao.ai/#random" title="随机跳转到一个有意思的网站" target="_blank" class="zhidao_ai"><img src="https://img.alicdn.com/imgextra/i2/O1CN01VjiZUL1r0eXge4taM_!!6000000005569-55-tps-300-300.svg" width="20" height="20"></a></div></div></div></div></div><div class="tools-wrapper" tabindex="0" aria-hidden="true"><a class="gotop icon" href="#" title="回到顶部">&#x2191;</a><a class="hash-to-comments icon" title="我要评论">&#x2121;</a></div><div class="fixerr" tabindex="0" aria-hidden="true">纠错模式</div></body><script src="https://fastly.jsdelivr.net/gh/barretlee/blog@gh-pages/public/js/jquery.js"></script><script src="https://fastly.jsdelivr.net/gh/barretlee/blog@gh-pages/public/js/main.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-67248043-3"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-67248043-3")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3524fff9629f2c80f8ea5daa13e67003";var t=document.getElementsByTagName("script")[0];t.async=!0,t.parentNode.insertBefore(e,t)}()</script><script>window.onerror=function(o){window.console&&window.console.log&&window.console.log(o);try{$("#loadLayer").remove()}catch(o){}return!0}</script></html>