(function(e,i){var t=function(){};var n=function(){this.calls=[];this.map={events:{friend:"menu:share:appmessage",timeline:"menu:share:timeline",weibo:"menu:share:weibo",email:"email"},actions:{friend:"sendAppMessage",timeline:"shareTimeline",weibo:"shareWeibo",email:"email"},direct:{network:"getNetworkType",hideToolbar:"hideToolbar",hideOptionMenu:"hideOptionMenu",showOptionMenu:"showOptionMenu",closeWebView:"closeWindow",scanQRCode:"scanQRCode",imagePreview:"imagePreview"}}};n.prototype._data=function(e,i){if(!e)return{};var n={};for(var t in e){if(!e.hasOwnProperty(t))return;n[t]=typeof e[t]==="function"?e[t]():e[t]}n.appid=n.app;n.appId=n.app;n.img_url=n.img;n.imgUrl=n.img;delete n.img;if(i==="weibo"){n.content=n.desc;n.url=n.link}else if(i==="timeline"){n.title=n.title+" - "+n.desc;n.desc=n.title}else if(i==="email"){n.content=n.desc+" "+n.link}return n};n.prototype._make=function(e){if(typeof WeixinJSBridge==="undefined")return this.calls.push(e);var i=e.name,n=this.map.direct[i],t=e.data,a=e.callback;if(n){if(i==="network"){return WeixinJSBridge.invoke(n,{},a)}else if(i==="imagePreview"){return WeixinJSBridge.invoke(n,t,a)}return WeixinJSBridge.call(n,a)}if(i==="email")return WeixinJSBridge.invoke("sendEmail",this._data(t,i),a);var r=this;WeixinJSBridge.on(this.map.events[i],function(){WeixinJSBridge.invoke(r.map.actions[i],r._data(t,i),a)})};n.prototype.on=function(e,i,n){if(!e)return;if(typeof i==="function"){n=i;i=null}this._make({name:e,data:i,callback:n||t});return this};var a=function(){for(var e=0,i=r.calls.length;e<i;e++){r._make(r.calls[e])}};var r=new n;var o=function(){return r.on.apply(r,arguments)};if(typeof exports!=="undefined"&&module.exports){module.exports=exports=o}else if(typeof define==="function"){define(function(e,i,n){n.exports=i=o})}else{e.wechat=e.wechat||o}if(typeof WeixinJSBridge==="undefined"){if(i.addEventListener){i.addEventListener("WeixinJSBridgeReady",a,false)}else{i.attachEvent("WeixinJSBridgeReady",a);i.attachEvent("onWeixinJSBridgeReady",a)}}else{a()}})(window,document);